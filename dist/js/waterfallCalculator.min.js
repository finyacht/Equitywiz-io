let DEFAULT_SHARE_CLASSES=[{id:1,name:"Series A",type:"preferred",i:1,t:1,o:"participating",l:null},{id:2,name:"Series B",type:"preferred",i:2,t:1.5,o:"participating",l:3},{id:3,name:"Common",type:"common",i:3,t:1,o:"non-participating",l:null}],DEFAULT_TRANSACTIONS=[{id:1,u:"Series A",m:1e6,p:1e6},{id:2,u:"Series B",m:2e6,p:2e6},{id:3,u:"Common",m:75e4,p:0}];function calculateDetailedWaterfall(r,i,e){let n=[],l=e;if(n.push({name:"Total Exit Proceeds",value:e,S:l,C:!0}),0!==i.length){e=r.filter(a=>i.some(e=>e.u===a.name));let a=i.reduce((e,a)=>e+(parseFloat(a.m)||0),0),t={};i.forEach(e=>{t[e.u]||(t[e.u]=0),t[e.u]+=(parseFloat(e.m)||0)/a});for(let a of[...e].filter(e=>"preferred"===e.type).sort((e,a)=>e.i-a.i)){if(l<=0)break;var o=i.filter(e=>e.u===a.name).reduce((e,a)=>e+parseFloat(a.p||0),0)*parseFloat(a.t||1);0<(o=Math.min(o,l))&&(n.push({name:a.name+" (Liquidation Preference)",value:-o,description:a.name+" receives liquidation preference of $"+o.toLocaleString(),S:l,u:a.name}),l-=o)}if(0<l){var u,m,c;let t=0;for(let a of r=[...e].sort((e,a)=>e.i-a.i))"preferred"===a.type&&"participating"!==a.o||(u=i.filter(e=>e.u===a.name).reduce((e,a)=>e+parseFloat(a.m||0),0),t+=u);for(let a of r){if(l<=0)break;if("preferred"!==a.type||"participating"===a.o){let e=i.filter(e=>e.u===a.name).reduce((e,a)=>e+parseFloat(a.m||0),0)/t*l;"preferred"===a.type&&a.l&&(c=i.filter(e=>e.u===a.name).reduce((e,a)=>e+parseFloat(a.p||0),0)*a.l,m=n.filter(e=>e.u===a.name).reduce((e,a)=>e-a.value,0),e=Math.min(e,c-m)),0<(e=Math.min(e,l))&&(c="common"===a.type?"Common Distribution":"Participation",n.push({name:a.name+` (${c})`,value:-e,description:`${a.name} receives ${c.toLowerCase()} of $`+e.toLocaleString(),S:l,u:a.name}),l-=e)}}}if(.01<l)if(0<(r=e.filter(e=>"common"===e.type)).length){let e=0;var p,f,s={};for(let a of r){var d=i.filter(e=>e.u===a.name).reduce((e,a)=>e+parseFloat(a.m||0),0);e+=d,s[a.name]=d}for(p of r)0<e&&0<(f=s[p.name]/e*l)&&(n.push({name:p.name+" (Additional Distribution)",value:-f,description:p.name+" receives additional distribution of $"+f.toLocaleString(),S:l,u:p.name}),l-=f)}else n.push({name:"Retained by Company",value:-l,description:`$${l.toLocaleString()} remains with the company`,S:l,A:!0})}return n}function calculateSummaryWaterfall(e,a,t){e=calculateDetailedWaterfall(e,a,t);let r={};return e.slice(1).forEach(e=>{var a;e.A?r.h={name:"Retained by Company",g:Math.abs(e.value),D:{v:Math.abs(e.value)}}:e.u&&(r[e.u]||(r[e.u]={name:e.u,g:0,D:{$:0,T:0,P:0,F:0}}),a=Math.abs(e.value),r[e.u].g+=a,e.name.includes("Liquidation Preference")?r[e.u].D.$+=a:e.name.includes("Participation")?r[e.u].D.T+=a:e.name.includes("Common Distribution")?r[e.u].D.P+=a:e.name.includes("Additional Distribution")&&(r[e.u].D.F+=a))}),Object.values(r).map(e=>({...e,L:Math.round(e.g/t*1e4)/100}))}function calculateExitDistribution(a,t,r,i=20){var n=[],l=[];for(let e=0;e<=i;e++){var o=r*e/i,o=(n.push(o),calculateSummaryWaterfall(a,t,o));l.push(o)}return{R:n,_:l}}function formatCurrency(e){return"$"+e.toLocaleString()}function getShareClassColor(e,a,t=1){return{W:`rgba(168, 85, 247, ${t})`,q:`rgba(59, 130, 246, ${t})`,M:`rgba(16, 185, 129, ${t})`,N:`rgba(245, 158, 11, ${t})`,U:`rgba(239, 68, 68, ${t})`,h:`rgba(107, 114, 128, ${t})`}[e]||`hsla(${137.5*a}, 70%, 50%, ${t})`}window.O={B:calculateDetailedWaterfall,H:calculateSummaryWaterfall,I:calculateExitDistribution,k:formatCurrency,j:getShareClassColor,V:DEFAULT_SHARE_CLASSES,G:DEFAULT_TRANSACTIONS};