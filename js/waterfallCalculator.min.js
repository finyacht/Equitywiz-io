let DEFAULT_SHARE_CLASSES=[{id:1,name:"Series A",type:"preferred",i:1,t:1,o:"participating",l:null},{id:2,name:"Series B",type:"preferred",i:2,t:1.5,o:"participating",l:3},{id:3,name:"Common",type:"common",i:3,t:1,o:"non-participating",l:null}],DEFAULT_TRANSACTIONS=[{id:1,u:"Series A",m:1e6,p:1e6},{id:2,u:"Series B",m:2e6,p:2e6},{id:3,u:"Common",m:75e4,p:0}];function calculateDetailedWaterfall(r,t,e){var n=[];let o=e;if(n.push({name:"Total Exit Proceeds",value:e,S:o,C:!0}),0!==t.length){e=r.filter(a=>t.some(e=>e.u===a.name));let a=t.reduce((e,a)=>e+(parseFloat(a.m)||0),0),i={};t.forEach(e=>{i[e.u]||(i[e.u]=0),i[e.u]+=(parseFloat(e.m)||0)/a});for(let a of[...e].filter(e=>"preferred"===e.type).sort((e,a)=>e.i-a.i)){if(o<=0)break;var l=t.filter(e=>e.u===a.name).reduce((e,a)=>e+parseFloat(a.p||0),0)*parseFloat(a.t||1),l=Math.min(l,o);0<l&&(n.push({name:a.name+" (Liquidation Preference)",value:-l,description:a.name+" receives liquidation preference of $"+l.toLocaleString(),S:o,u:a.name}),o-=l)}if(0<o){var s,c,u,r=[...e].sort((e,a)=>e.i-a.i);let i=0;for(let a of r)"preferred"===a.type&&"participating"!==a.o||(s=t.filter(e=>e.u===a.name).reduce((e,a)=>e+parseFloat(a.m||0),0),i+=s);for(let a of r){if(o<=0)break;if("preferred"!==a.type||"participating"===a.o){let e=t.filter(e=>e.u===a.name).reduce((e,a)=>e+parseFloat(a.m||0),0)/i*o;"preferred"===a.type&&a.l&&(u=t.filter(e=>e.u===a.name).reduce((e,a)=>e+parseFloat(a.p||0),0)*a.l,c=n.filter(e=>e.u===a.name).reduce((e,a)=>e-a.value,0),e=Math.min(e,u-c)),0<(e=Math.min(e,o))&&(u="common"===a.type?"Common Distribution":"Participation",n.push({name:a.name+` (${u})`,value:-e,description:`${a.name} receives ${u.toLowerCase()} of $`+e.toLocaleString(),S:o,u:a.name}),o-=e)}}}if(.01<o){r=e.filter(e=>"common"===e.type);if(0<r.length){let e=0;var m,f,p={};for(let a of r){var d=t.filter(e=>e.u===a.name).reduce((e,a)=>e+parseFloat(a.m||0),0);e+=d,p[a.name]=d}for(m of r)0<e&&0<(f=p[m.name]/e*o)&&(n.push({name:m.name+" (Additional Distribution)",value:-f,description:m.name+" receives additional distribution of $"+f.toLocaleString(),S:o,u:m.name}),o-=f)}else n.push({name:"Retained by Company",value:-o,description:`$${o.toLocaleString()} remains with the company`,S:o,A:!0})}}return n}function calculateSummaryWaterfall(e,a,i){e=calculateDetailedWaterfall(e,a,i);let r={};return e.slice(1).forEach(e=>{var a;e.A?r["h"]={name:"Retained by Company",g:Math.abs(e.value),D:{v:Math.abs(e.value)}}:e.u&&(r[e.u]||(r[e.u]={name:e.u,g:0,D:{$:0,T:0,P:0,F:0}}),a=Math.abs(e.value),r[e.u].g+=a,e.name.includes("Liquidation Preference")?r[e.u].D["$"]+=a:e.name.includes("Participation")?r[e.u].D.T+=a:e.name.includes("Common Distribution")?r[e.u].D["P"]+=a:e.name.includes("Additional Distribution")&&(r[e.u].D["F"]+=a))}),Object.values(r).map(e=>({...e,L:Math.round(e.g/i*1e4)/100}))}function calculateExitDistribution(a,i,r,t=20){var n=[],o=[];for(let e=0;e<=t;e++){var l=r*e/t,l=(n.push(l),calculateSummaryWaterfall(a,i,l));o.push(l)}return{R:n,_:o}}function formatCurrency(e){return"$"+e.toLocaleString()}function getShareClassColor(e,a,i=1){return{W:`rgba(168, 85, 247, ${i})`,q:`rgba(59, 130, 246, ${i})`,M:`rgba(16, 185, 129, ${i})`,N:`rgba(245, 158, 11, ${i})`,U:`rgba(239, 68, 68, ${i})`,h:`rgba(107, 114, 128, ${i})`}[e]||`hsla(${137.5*a}, 70%, 50%, ${i})`}window.O={B:calculateDetailedWaterfall,H:calculateSummaryWaterfall,I:calculateExitDistribution,k:formatCurrency,j:getShareClassColor,V:DEFAULT_SHARE_CLASSES,G:DEFAULT_TRANSACTIONS};